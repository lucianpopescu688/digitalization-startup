<%- include('../layout', { body: %>
<div class="page-container">
    <div class="page-header">
        <h1>Edit Video Details</h1>
        <p>Update information for "<%= video.title || video.original_name %>"</p>
    </div>

    <div class="edit-container">
        <div class="edit-form-container">
            <!-- Display errors -->
            <% if (typeof errors !== 'undefined' && errors.length > 0) { %>
            <div class="error-messages">
                <% errors.forEach(error => { %>
                <div class="error-message"><%= error.msg %></div>
                <% }) %>
            </div>
            <% } %>

            <form action="/videos/<%= video.id %>/edit" method="POST" class="edit-form">
                <div class="form-section">
                    <h3>Basic Information</h3>
                    
                    <div class="form-group">
                        <label for="title">Title</label>
                        <input 
                            type="text" 
                            id="title" 
                            name="title" 
                            value="<%= typeof formData !== 'undefined' ? formData.title : video.title || '' %>"
                            maxlength="200"
                            placeholder="Enter a descriptive title for this video"
                        >
                        <small>A good title helps others find and understand your video</small>
                    </div>

                    <div class="form-group">
                        <label for="description">Description</label>
                        <textarea 
                            id="description" 
                            name="description" 
                            rows="6" 
                            maxlength="1000"
                            placeholder="Describe the content, when it was recorded, who's in it, and any other relevant details..."
                        ><%= typeof formData !== 'undefined' ? formData.description : video.description || '' %></textarea>
                        <small>Detailed descriptions make videos more discoverable and meaningful</small>
                    </div>

                    <div class="form-group">
                        <label for="tags">Tags</label>
                        <input 
                            type="text" 
                            id="tags" 
                            name="tags" 
                            value="<%= typeof formData !== 'undefined' ? formData.tags : video.tags || '' %>"
                            maxlength="500"
                            placeholder="family, vacation, wedding, 1990s, christmas, etc."
                        >
                        <small>Separate multiple tags with commas. Use specific terms for better search results.</small>
                    </div>
                </div>

                <div class="form-actions">
                    <button type="submit" class="btn btn-primary">Save Changes</button>
                    <a href="/videos/<%= video.id %>" class="btn btn-secondary">Cancel</a>
                    <a href="/dashboard" class="btn btn-secondary">Back to Dashboard</a>
                </div>
            </form>
        </div>

        <div class="edit-sidebar">
            <div class="video-preview">
                <div class="preview-thumbnail">
                    <div class="preview-play-button">▶</div>
                    <div class="preview-duration">
                        <% if (video.duration) { %>
                        <%= Math.floor(video.duration / 60) %>:<%= (video.duration % 60).toString().padStart(2, '0') %>
                        <% } else { %>
                        --:--
                        <% } %>
                    </div>
                </div>
                
                <div class="preview-info">
                    <h4><%= video.original_name %></h4>
                    <p class="preview-meta">
                        <%= (video.file_size / 1024 / 1024).toFixed(1) %>MB • 
                        <%= video.mime_type %> • 
                        Uploaded <%= new Date(video.upload_date).toLocaleDateString() %>
                    </p>
                </div>
            </div>

            <div class="edit-tips">
                <h3>Tips for Better Organization</h3>
                <ul>
                    <li><strong>Title:</strong> Use descriptive titles that indicate the content and time period</li>
                    <li><strong>Description:</strong> Include dates, locations, people, and context</li>
                    <li><strong>Tags:</strong> Add relevant keywords like years, events, family names, locations</li>
                    <li><strong>Search:</strong> Good metadata makes videos easier to find later</li>
                </ul>
            </div>

            <div class="file-info">
                <h3>File Details</h3>
                <div class="info-grid">
                    <div class="info-item">
                        <span class="info-label">Original Name:</span>
                        <span class="info-value"><%= video.original_name %></span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">File Size:</span>
                        <span class="info-value"><%= (video.file_size / 1024 / 1024).toFixed(2) %> MB</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Format:</span>
                        <span class="info-value"><%= video.mime_type %></span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Uploaded:</span>
                        <span class="info-value"><%= new Date(video.upload_date).toLocaleDateString() %></span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
.edit-container {
    display: grid;
    grid-template-columns: 2fr 1fr;
    gap: 32px;
}

.edit-form-container {
    background: white;
    padding: 32px;
    border-radius: 12px;
    box-shadow: 0 4px 6px rgba(0,0,0,0.05);
    border: 1px solid #e2e8f0;
}

.form-section {
    margin-bottom: 32px;
}

.form-section h3 {
    font-size: 1.3rem;
    font-weight: 600;
    margin-bottom: 20px;
    color: #2d3748;
    padding-bottom: 8px;
    border-bottom: 2px solid #e2e8f0;
}

.form-actions {
    display: flex;
    gap: 16px;
    flex-wrap: wrap;
}

.edit-sidebar {
    display: flex;
    flex-direction: column;
    gap: 24px;
}

.video-preview,
.edit-tips,
.file-info {
    background: white;
    padding: 24px;
    border-radius: 12px;
    box-shadow: 0 4px 6px rgba(0,0,0,0.05);
    border: 1px solid #e2e8f0;
}

.preview-thumbnail {
    position: relative;
    height: 120px;
    background: linear-gradient(135deg, #e2e8f0 0%, #cbd5e0 100%);
    border-radius: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    margin-bottom: 16px;
}

.preview-play-button {
    font-size: 2rem;
    color: white;
    text-shadow: 0 2px 4px rgba(0,0,0,0.3);
}

.preview-duration {
    position: absolute;
    bottom: 8px;
    right: 8px;
    background: rgba(0,0,0,0.8);
    color: white;
    padding: 4px 8px;
    border-radius: 4px;
    font-size: 12px;
    font-weight: 500;
}

.preview-info h4 {
    font-size: 1rem;
    font-weight: 600;
    margin-bottom: 8px;
    color: #2d3748;
    word-break: break-word;
}

.preview-meta {
    color: #718096;
    font-size: 12px;
}

.edit-tips h3,
.file-info h3 {
    font-size: 1.1rem;
    font-weight: 600;
    margin-bottom: 16px;
    color: #2d3748;
}

.edit-tips ul {
    list-style: none;
    padding: 0;
}

.edit-tips li {
    margin-bottom: 12px;
    color: #4a5568;
    line-height: 1.5;
}

.edit-tips li strong {
    color: #2d3748;
}

.info-grid {
    display: grid;
    gap: 12px;
}

.info-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 8px 0;
    border-bottom: 1px solid #f1f5f9;
}

.info-item:last-child {
    border-bottom: none;
}

.info-label {
    font-weight: 500;
    color: #718096;
    font-size: 14px;
}

.info-value {
    color: #2d3748;
    font-weight: 500;
    font-size: 14px;
    text-align: right;
    word-break: break-word;
}

@media (max-width: 768px) {
    .edit-container {
        grid-template-columns: 1fr;
    }
    
    .form-actions {
        flex-direction: column;
    }
    
    .info-item {
        flex-direction: column;
        align-items: flex-start;
        gap: 4px;
    }
    
    .info-value {
        text-align: left;
    }
}
</style>
<% }) %>